<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignUp</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="static/style.css">
</head>

<body>

    <!-- Header -->
    <nav class="header navbar navbar-expand-lg navbar-light ">
        <div class="container d-flex justify-content-center">
            <a class="navbar-brand text-white fs-2 h1" href="#">Endless Tales & Adventures</a>
        </div>
    </nav>

    <!-- NavBar -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav d-flex justify-content-end">
                
                <li class="nav-item">
                    <a class="nav-link" href="{{url_for('login')}}">Login</a>
                </li>
            </ul>
        </div>
    </nav>

    <div>
        <form class="changepswd container box mt-5 p-5 pt-1 col-lg-6" name="signupForm" action="{{ url_for('register') }}" method="POST">
            <p class="text-success">{{ msg }}</p>
            <h1 class="text-center m-2 mb-4">SignUp</h1>

            <div class="form-group">
                <label for="username">UserName</label>
                <input type="text" class="form-control mt-1 mb-3" name="username" id="username">
                <p id="nameError" style="color: red;"></p>
            </div>

            <div class="form-group">
                <label for="email">Email Address</label>
                <input type="text" class="form-control mt-1 mb-3" name="email" id="email">
                <p id="mailError" style="color: red;"></p>
            </div>

            <div class="form-group">
                <label for="password">New Password</label>
                <input type="password" class="form-control mt-1 mb-3" name="password" id="password">
                <p id="newError" style="color: red;"></p>
            </div>

            <div class="form-group">
                <label for="confirmPassword">Confirm Password</label>
                <input type="password" class="form-control mt-1 mb-3" id="confirmPassword">
                <p id="confirmError" style="color: red;"></p>
            </div>

            <div class="d-flex justify-content-center mt-3">
                <button type="submit" id="signupBtn" class="btn text-center" style="background-color: #8f2afa;color:white">SignUp</button>
            </div>

            <div class="mt-3 extra">
                Already have an account?<a href="{{ url_for('login') }}"> Login</a>
            </div>
        </form>
    </div>

    <!-- Footer -->
    <div class="footer text-center p-2 mt-3">
        <p>&copy;2024 CopyRight: Online story teller.com</p>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- <script>
        document.querySelector("form[name='signupForm']").addEventListener("submit", function(event) {
            let isValid = true;

            // Get form values
            const username = document.getElementById("username").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirmPassword").value;

            // Clear previous error messages
            document.getElementById("nameError").textContent = "";
            document.getElementById("mailError").textContent = "";
            document.getElementById("newError").textContent = "";
            document.getElementById("confirmError").textContent = "";

            // Username validation
            if (username === "") {
                document.getElementById("nameError").textContent = "Name cannot be empty";
                isValid = false;
            }

            // Email validation
            const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            if (!email.match(emailRegex)) {
                document.getElementById("mailError").textContent = "Please enter a valid email address";
                isValid = false;
            }

            // Password validation
            if (password === "") {
                document.getElementById("newError").textContent = "Password cannot be empty";
                isValid = false;
            } else if (password.length < 8) {
                document.getElementById("newError").textContent = "Password must be at least 8 characters long";
                isValid = false;
            }

            // Confirm password validation
            if (confirmPassword !== password) {
                document.getElementById("confirmError").textContent = "Passwords must match";
                isValid = false;
            }

            // Debugging: Log to check if event is firing and if values are correct
            console.log('Form is valid:', isValid);
            console.log('Username:', username);
            console.log('Email:', email);
            console.log('Password:', password);
            console.log('Confirm Password:', confirmPassword);

            // If form is invalid, prevent submission
            if (!isValid) {
                event.preventDefault();
            }
        });
    </script> -->
    <script>
        document.querySelector("form[name='signupForm']").addEventListener("submit", function(event) {
            let isValid = true;

            // Get form values
            const username = document.getElementById("username").value;
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const confirmPassword = document.getElementById("confirmPassword").value;

            // Clear previous error messages
            document.getElementById("nameError").style.display = "none";
            document.getElementById("mailError").style.display = "none";
            document.getElementById("newError").style.display = "none";
            document.getElementById("confirmError").style.display = "none";

            // Username validation
            if (username === "") {
                document.getElementById("nameError").textContent = "Name cannot be empty";
                document.getElementById("nameError").style.display = "block";
                isValid = false;
            }

            // Email validation
            const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
            if (!email.match(emailRegex)) {
                document.getElementById("mailError").textContent = "Please enter a valid email address";
                document.getElementById("mailError").style.display = "block";
                isValid = false;
            }

            // Password validation
            if (password === "") {
                document.getElementById("newError").textContent = "Password cannot be empty";
                document.getElementById("newError").style.display = "block";
                isValid = false;
            } else if (password.length < 8) {
                document.getElementById("newError").textContent = "Password must be at least 8 characters long";
                document.getElementById("newError").style.display = "block";
                isValid = false;
            }

            // Confirm password validation
            if (confirmPassword !== password) {
                document.getElementById("confirmError").textContent = "Passwords must match";
                document.getElementById("confirmError").style.display = "block";
                isValid = false;
            }

            // If form is invalid, prevent submission
            if (!isValid) {
                event.preventDefault();
            }
        });
    </script>
</body>

</html>
